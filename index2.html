<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AstraLens - Interactive Lunar Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet-polyline-measure@2.1.1/Leaflet.Polyline.Measure.css" />
    <script src="https://unpkg.com/leaflet-polyline-measure@2.1.1/Leaflet.Polyline.Measure.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0a0a1a; color: #e0e0e0; }
        .hero-bg { background-image: linear-gradient(rgba(10, 10, 26, 0.8), rgba(10, 10, 26, 1)), url('https://images.nasa.gov/images/the-terminator-of-the-moon/the-terminator-of-the-moon~orig.jpg'); background-size: cover; background-position: center; }
        .glass-effect { background: rgba(16, 16, 32, 0.6); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .feature-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4); }
        .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }
        /* Map Styles */
        #map-container { height: 75vh; border-radius: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.1); background: #050510; }
        .leaflet-popup-content-wrapper { background: #101020; color: #e0e0e0; border-radius: 8px; box-shadow: 0 3px 14px rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); width: 300px; }
        .leaflet-popup-content { margin: 15px; }
        .leaflet-popup-tip { background: #101020; }
        .leaflet-control-layers { background: rgba(16, 16, 32, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); color: #e0e0e0; border-radius: 8px; }
        .leaflet-tile { filter: grayscale(10%) brightness(100%) contrast(110%); }
        .popup-image { max-width: 100%; height: auto; border-radius: 4px; margin-top: 10px; background-color: #222; }
        .popup-title { font-weight: bold; color: #67e8f9; font-size: 16px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px;}
        .popup-analysis { font-size: 13px; color: #cbd5e1; margin-top: 10px; font-style: italic; border-left: 3px solid #67e8f9; padding-left: 10px;}
        .popup-details { font-size: 12px; color: #9ca3af; margin-top: 12px; line-height: 1.8; }
        .popup-details strong { color: #e0e0e0; font-weight: 600; }
        .leaflet-control-measure { border-radius: 8px !important; }
    </style>
</head>
<body class="antialiased">

    <header id="header" class="glass-effect fixed top-0 left-0 right-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
             <a href="#" class="flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-cyan-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0L12 2.69z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                <span class="text-2xl font-bold text-white">AstraLens</span>
            </a>
            <nav class="hidden md:flex items-center space-x-6">
                <a href="#features" class="text-gray-300 hover:text-cyan-400 transition">Features</a>
                <a href="#interactive-map" class="text-gray-300 hover:text-cyan-400 transition">Explorer</a>
                <a href="#interactive-map" class="bg-cyan-500 hover:bg-cyan-600 text-white font-semibold py-2 px-4 rounded-lg transition">Launch App</a>
            </nav>
        </div>
    </header>
    <main class="hero-bg">
        <div class="container mx-auto px-4 pt-48 pb-32 text-center">
            <h1 class="text-4xl md:text-6xl font-bold text-white leading-tight mb-4">Visualize Real Mission Data.<br>Explore the Lunar Surface.</h1>
            <p class="text-lg md:text-xl text-gray-300 max-w-3xl mx-auto mb-8">AstraLens makes NASA's vast lunar image archives interactive, plotting thousands of real observations from the Apollo and ShadowCam missions.</p>
            <a href="#interactive-map" class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 transform hover:scale-105">Launch Explorer</a>
        </div>
    </main>
    <section id="features" class="py-20 sm:py-24">
        <div class="container mx-auto px-4">
             <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-white">A New Way to See the Moon</h2>
                <p class="text-gray-400 mt-2 max-w-2xl mx-auto">Our powerful tools transform mission datasets into a seamless, explorable canvas.</p>
            </div>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="feature-card glass-effect p-6 rounded-xl text-center transition duration-300 fade-in"><div class="flex justify-center mb-4"><svg class="h-12 w-12 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503-6.998 4.875-2.25L21 12m-12 0h12M3 12l9 9 9-9M3 6l9 9 9-9" /></svg></div><h3 class="text-xl font-semibold text-white mb-2">Real Data, Real Science</h3><p class="text-gray-400">Explore thousands of data points directly from your CSV files, plotted accurately on the lunar surface.</p></div>
                <div class="feature-card glass-effect p-6 rounded-xl text-center transition duration-300 fade-in" style="transition-delay: 100ms;"><div class="flex justify-center mb-4"><svg class="h-12 w-12 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M21.75 12h-2.25m-1.591 5.834-1.591-1.591M12 19.5V21.75m-5.834-1.666 1.591-1.591M2.25 12h2.25m1.591-5.834 1.591 1.591" /></svg></div><h3 class="text-xl font-semibold text-white mb-2">Heatmap Analysis</h3><p class="text-gray-400">Instantly visualize the density of observations to see where missions focused their attention, from equatorial orbits to polar targets.</p></div>
                <div class="feature-card glass-effect p-6 rounded-xl text-center transition duration-300 fade-in" style="transition-delay: 200ms;"><div class="flex justify-center mb-4"><svg class="h-12 w-12 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.898 20.575 16.5 21.75l-.398-1.175a3.375 3.375 0 0 0-2.456-2.456L12.75 18l1.175-.398a3.375 3.375 0 0 0 2.456-2.456L16.5 14.25l.398 1.175a3.375 3.375 0 0 0 2.456 2.456L20.25 18l-1.175.398a3.375 3.375 0 0 0-2.456 2.456Z" /></svg></div><h3 class="text-xl font-semibold text-white mb-2">AI-Powered Analysis</h3><p class="text-gray-400">Each data point includes a simulated AI summary, providing instant scientific context about the observation's purpose and conditions.</p></div>
                <div class="feature-card glass-effect p-6 rounded-xl text-center transition duration-300 fade-in" style="transition-delay: 300ms;"><div class="flex justify-center mb-4"><svg class="h-12 w-12 text-cyan-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25" /></svg></div><h3 class="text-xl font-semibold text-white mb-2">Measure Anything</h3><p class="text-gray-400">Use the built-in measurement tool to calculate the distance between any two points on the lunar surface in kilometers.</p></div>
            </div>
        </div>
    </section>

    <section id="interactive-map" class="py-20 sm:py-24 bg-black bg-opacity-20">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-white">Interactive Lunar Data Explorer</h2>
                <p class="text-gray-400 mt-2 max-w-2xl mx-auto">Explore image data from historic missions plotted on the lunar surface. Use the layer control in the top right to toggle datasets and heatmaps.</p>
            </div>
            <div class="relative glass-effect p-2 sm:p-4 rounded-xl">
                 <div id="map-container"></div>
            </div>
        </div>
    </section>

    <footer class="border-t border-gray-800 mt-24">
        <div class="container mx-auto px-4 py-8"><div class="flex flex-col md:flex-row justify-between items-center text-center md:text-left"><div class="mb-4 md:mb-0"><a href="#" class="flex items-center justify-center md:justify-start space-x-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0L12 2.69z"></path><circle cx="12" cy="12" r="3"></circle></svg><span class="text-xl font-bold text-white">AstraLens</span></a><p class="text-gray-500 mt-2">Making cosmic data universally accessible.</p></div><div class="text-gray-400"><p>&copy; 2025 AstraLens. All rights reserved.</p><p class="text-sm">Built for the NASA Space Apps Challenge. Data courtesy of NASA.</p></div></div></div>
    </footer>

    <script>
        window.onload = function() {
            // --- Static page scripts ---
            const faders = document.querySelectorAll('.fade-in');
            const appearOptions = { threshold: 0.1, rootMargin: "0px 0px -50px 0px" };
            const appearOnScroll = new IntersectionObserver(function(entries, observer) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, appearOptions);
            faders.forEach(fader => appearOnScroll.observe(fader));
            
            // --- Interactive map script ---
            const map = L.map('map-container').setView([0, 0], 2);
            L.tileLayer('https://cartocdn-gusc.global.ssl.fastly.net/opmbuilder/api/v1/map/named/opm-moon-basemap-v0-1/all/{z}/{x}/{y}.png', {
                attribution: 'OpenPlanetaryMap & USGS/LRO',
                maxZoom: 10,
                minZoom: 2
            }).addTo(map);

            // --- DATA EMBEDDED FROM YOUR CSVs ---
            const apolloDpscData = [{"lat":24.7,"lon":52.1,"id":"AS17-P-2051","thumb":"https://pds-imaging.jpl.nasa.gov/data/lo/LO_1001/EXTRAS/BROWSE/1/1105_H3.JPG","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_pan_search/view/?f=AS17-P-2051","mission":"Apollo 17","instrument":"Panoramic Camera"},{"lat":24.6,"lon":51.7,"id":"AS17-P-2053","thumb":"https://pds-imaging.jpl.nasa.gov/data/lo/LO_1001/EXTRAS/BROWSE/1/1105_H3.JPG","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_pan_search/view/?f=AS17-P-2053","mission":"Apollo 17","instrument":"Panoramic Camera"}];
            const apolloMetricData = [{"lat":-16.8,"lon":-57.7,"id":"AS15-M-0001","thumb":"https://pds-imaging.jpl.nasa.gov/data/apollo/apollo_15/metric/AS15-M-0001_125.png","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_metric_search/view?f=AS15-M-0001","mission":"Apollo 15","instrument":"Metric Camera","resolution":20.0},{"lat":-15.6,"lon":-57.9,"id":"AS15-M-0002","thumb":"https://pds-imaging.jpl.nasa.gov/data/apollo/apollo_15/metric/AS15-M-0002_125.png","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_metric_search/view?f=AS15-M-0002","mission":"Apollo 15","instrument":"Metric Camera","resolution":20.0},{"lat":-14.4,"lon":-58.1,"id":"AS15-M-0003","thumb":"https://pds-imaging.jpl.nasa.gov/data/apollo/apollo_15/metric/AS15-M-0003_125.png","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_metric_search/view?f=AS15-M-0003","mission":"Apollo 15","instrument":"Metric Camera","resolution":20.0},{"lat":-12.0,"lon":-58.5,"id":"AS15-M-0005","thumb":"https://pds-imaging.jpl.nasa.gov/data/apollo/apollo_15/metric/AS15-M-0005_125.png","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_metric_search/view?f=AS15-M-0005","mission":"Apollo 15","instrument":"Metric Camera","resolution":20.0}];
            const apolloPanData = [{"lat":27.2,"lon":-3.1,"id":"AS15-P-8141","thumb":"https://pds-imaging.jpl.nasa.gov/data/lo/LO_1001/EXTRAS/BROWSE/1/1104_H3.JPG","url":"https://pds-imaging.jpl.nasa.gov/portal/apollo_pan_search/view/?f=AS15-P-8141","mission":"Apollo 15","instrument":"Panoramic Camera"}];
            const shadowCamData = [{"lat":-88.6,"lon":32.2,"id":"LRO_SC_E_20220912_105436_V01","thumb":"https://pds-imaging.jpl.nasa.gov/data/lro/shadowcam/LRO_SC_1001/DATA/EDR/2022/255/LRO_SC_E_20220912_105436_V01_BROWSE.png","url":"https://pds-imaging.jpl.nasa.gov/portal/shadowcam_search/view?f=LRO_SC_E_20220912_105436_V01","instrument":"ShadowCam","incidence_angle":85.3},{"lat":-88.8,"lon":52.1,"id":"LRO_SC_E_20220912_123230_V01","thumb":"https://pds-imaging.jpl.nasa.gov/data/lro/shadowcam/LRO_SC_1001/DATA/EDR/2022/255/LRO_SC_E_20220912_123230_V01_BROWSE.png","url":"https://pds-imaging.jpl.nasa.gov/portal/shadowcam_search/view?f=LRO_SC_E_20220912_123230_V01","instrument":"ShadowCam","incidence_angle":85.0},{"lat":-88.7,"lon":109.9,"id":"LRO_SC_E_20220912_141025_V01","thumb":"https://pds-imaging.jpl.nasa.gov/data/lro/shadowcam/LRO_SC_1001/DATA/EDR/2022/255/LRO_SC_E_20220912_141025_V01_BROWSE.png","url":"https://pds-imaging.jpl.nasa.gov/portal/shadowcam_search/view?f=LRO_SC_E_20220912_141025_V01","instrument":"ShadowCam","incidence_angle":84.7}];
           
            const createIcon = (color) => L.divIcon({
                html: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill-opacity="0.8" fill="${color}" class="h-5 w-5 drop-shadow-lg"><path d="M8 .5a7.5 7.5 0 1 0 0 15 7.5 7.5 0 0 0 0-15ZM8 12a4 4 0 1 1 0-8 4 4 0 0 1 0 8Z" /></svg>`,
                className: '', iconSize: [20, 20], iconAnchor: [10, 10]
            });

            const plotData = (dataArray, layerGroup, icon) => {
                dataArray.forEach(item => {
                    // Generate Analytical Summary
                    let analysis = "";
                    if (item.instrument === 'ShadowCam') {
                        analysis = `This image targets a Permanently Shadowed Region (PSR). The extremely high sun incidence angle of <strong>${item.incidence_angle}°</strong> indicates it was taken using only secondary illumination (reflected light), a key technique in the search for surface water ice.`;
                    } else if (item.instrument && item.instrument.includes('Camera')) {
                        analysis = `This photograph was captured by the <strong>${item.instrument}</strong> during the <strong>${item.mission}</strong> mission. Such orbital imagery was crucial for geologic mapping and selecting future landing sites.`;
                    }

                    // Build the rich popup content
                    let details = `<div class="popup-details"><strong>Mission:</strong> ${item.mission || 'N/A'}<br><strong>Instrument:</strong> ${item.instrument || 'N/A'}`;
                    if (item.resolution) details += `<br><strong>Resolution:</strong> ${item.resolution} m/px`;
                    if (item.incidence_angle) details += `<br><strong>Sun Angle:</strong> ${item.incidence_angle}°`;
                    details += `</div>`;

                    const popupContent = `
                        <div>
                            <div class="popup-title">${item.id}</div>
                            <p class="popup-analysis">${analysis}</p>
                            ${details}
                            <a href="${item.url}" target="_blank" rel="noopener noreferrer">
                                <img src="${item.thumb}" alt="Loading thumbnail..." class="popup-image" onerror="this.style.display='none'">
                            </a>
                        </div>`;
                    L.marker([item.lat, item.lon], { icon: icon }).addTo(layerGroup).bindPopup(popupContent);
                });
            };

            // Create Layer Groups
            const apolloDpscLayer = L.layerGroup();
            const apolloMetricLayer = L.layerGroup();
            const apolloPanLayer = L.layerGroup();
            const shadowCamLayer = L.layerGroup();
            
            const apolloDpscHeat = L.heatLayer(apolloDpscData.map(p => [p.lat, p.lon, 0.5]), { radius: 15, gradient: {0.4: 'blue', 0.65: 'lime', 1: 'red'} });
            const apolloMetricHeat = L.heatLayer(apolloMetricData.map(p => [p.lat, p.lon, 0.5]), { radius: 15 });
            const apolloPanHeat = L.heatLayer(apolloPanData.map(p => [p.lat, p.lon, 0.5]), { radius: 15, gradient: {0.4: 'yellow', 0.8: 'orange', 1: 'red'} });
            const shadowCamHeat = L.heatLayer(shadowCamData.map(p => [p.lat, p.lon, 1.0]), { radius: 20, blur: 25, max: 0.5, gradient: {0.4: 'cyan', 0.8: 'white'} });

            // Plot data
            plotData(apolloDpscData, apolloDpscLayer, createIcon('#f59e0b'));
            plotData(apolloMetricData, apolloMetricLayer, createIcon('#84cc16'));
            plotData(apolloPanData, apolloPanLayer, createIcon('#ef4444'));
            plotData(shadowCamData, shadowCamLayer, createIcon('#38bdf8'));

            // Add Layer Control
            const overlayMaps = {
                "<span style='color: #f59e0b; font-weight: bold;'>Apollo DPSC Points</span>": apolloDpscLayer,
                "Apollo DPSC Heatmap": apolloDpscHeat,
                "<span style='color: #84cc16; font-weight: bold;'>Apollo Metric Points</span>": apolloMetricLayer,
                "Apollo Metric Heatmap": apolloMetricHeat,
                "<span style='color: #ef4444; font-weight: bold;'>Apollo Pan Points</span>": apolloPanLayer,
                "Apollo Pan Heatmap": apolloPanHeat,
                "<span style='color: #38bdf8; font-weight: bold;'>ShadowCam Points</span>": shadowCamLayer,
                "ShadowCam Heatmap": shadowCamHeat
            };
            L.control.layers(null, overlayMaps, { collapsed: false }).addTo(map);

            // Add default layers
            apolloDpscLayer.addTo(map);
            apolloMetricLayer.addTo(map);
            apolloPanLayer.addTo(map);
            shadowCamLayer.addTo(map);

            // Add Measurement Tool
            L.control.polylineMeasure({ position: 'topleft', measureControlTitle: 'Measure distance' }).addTo(map);
        };
    </script>
</body>
</html>